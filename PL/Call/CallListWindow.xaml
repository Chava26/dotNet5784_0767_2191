<!--<Window x:Class="PL.CallListWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:local="clr-namespace:PL"
        Title="Call Management" Height="400" Width="900"
        DataContext="{Binding RelativeSource={RelativeSource Self}}"
        xmlns:conv="clr-namespace:PL.Converters"
        WindowStartupLocation="CenterScreen">

    <Window.Resources>

        <conv:DeleteButtonVisibilityConverter x:Key="DeleteButtonVisibilityConverter" />
        <conv:CancelAssignmentVisibilityConverter x:Key="CancelAssignmentVisibilityConverter" />
        <DataTemplate x:Key="CallRowTemplate">
            <Grid Margin="2">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="80"/>
                    <ColumnDefinition Width="120"/>
                    <ColumnDefinition Width="120"/>
                    <ColumnDefinition Width="120"/>
                    <ColumnDefinition Width="120"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="80"/>
                    <ColumnDefinition Width="110"/>
                </Grid.ColumnDefinitions>
                <TextBlock Grid.Column="0" Text="{Binding CallId}" VerticalAlignment="Center"/>
                <TextBlock Grid.Column="1" Text="{Binding CallType}" VerticalAlignment="Center"/>
                <TextBlock Grid.Column="2" Text="{Binding Status}" VerticalAlignment="Center"/>
                <TextBlock Grid.Column="3" Text="{Binding OpenTime, StringFormat=dd/MM/yyyy HH:mm}" VerticalAlignment="Center"/>
                <TextBlock Grid.Column="4" Text="{Binding LastVolunteerName}" VerticalAlignment="Center"/>
                <TextBlock Grid.Column="5" Text="{Binding AssignmentsCount}" VerticalAlignment="Center"/>
                <Button Grid.Column="6" Content="Delete" Margin="2,0,0,0"
                        Click="DeleteCall_Click"
                        Visibility="{Binding Path=., Converter={StaticResource DeleteButtonVisibilityConverter}}"
                        Tag="{Binding}"/>
                <Button Grid.Column="7" Content="Cancel Assignment" Margin="2,0,0,0"
                        Click="CancelAssignment_Click"
                        Visibility="{Binding Path=., Converter={StaticResource CancelAssignmentVisibilityConverter}}"
                        Tag="{Binding}"/>
            </Grid>
        </DataTemplate>

    </Window.Resources>

    <DockPanel>
        --><!-- Filter/Sort/Group Bar --><!--
        <StackPanel Orientation="Horizontal" DockPanel.Dock="Top" Margin="10">
            <TextBlock Text="Filter by Type:" Margin="0,0,5,0" VerticalAlignment="Center"/>
            <ComboBox ItemsSource="{Binding CallTypeCollection}"
                      SelectedItem="{Binding SelectedCallType, Mode=TwoWay}"
                      Width="110" Margin="0,0,10,0"
                      VerticalAlignment="Center"
                      SelectionChanged="Filter_Changed"/>
            <TextBlock Text="Filter by Status:" Margin="0,0,5,0" VerticalAlignment="Center"/>
            <ComboBox ItemsSource="{Binding CallStatusCollection}"
                      SelectedItem="{Binding SelectedCallStatus, Mode=TwoWay}"
                      Width="110" Margin="0,0,10,0"
                      VerticalAlignment="Center"
                      SelectionChanged="Filter_Changed"/>
            <TextBlock Text="Sort by:" Margin="0,0,5,0" VerticalAlignment="Center"/>
            <ComboBox ItemsSource="{Binding SortFields}"
                      SelectedItem="{Binding SelectedSortField, Mode=TwoWay}"
                      Width="110" Margin="0,0,10,0"
                      VerticalAlignment="Center"
                      SelectionChanged="Filter_Changed"/>
            <TextBlock Text="Group by:" Margin="0,0,5,0" VerticalAlignment="Center"/>
            <ComboBox ItemsSource="{Binding GroupFields}"
                      SelectedItem="{Binding SelectedGroupField, Mode=TwoWay}"
                      Width="110"
                      VerticalAlignment="Center"
                      SelectionChanged="Filter_Changed"/>
            <Button Content="Add Call" Margin="20,0,0,0" Padding="10,2"
                    Click="AddCall_Click"/>
        </StackPanel>

        --><!-- Headers --><!--
        <Grid DockPanel.Dock="Top" Margin="10,0,10,0">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="80"/>
                <ColumnDefinition Width="120"/>
                <ColumnDefinition Width="120"/>
                <ColumnDefinition Width="120"/>
                <ColumnDefinition Width="120"/>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="80"/>
            </Grid.ColumnDefinitions>
            <TextBlock Grid.Column="0" Text="ID" FontWeight="Bold"/>
            <TextBlock Grid.Column="1" Text="Call Type" FontWeight="Bold"/>
            <TextBlock Grid.Column="2" Text="Status" FontWeight="Bold"/>
            <TextBlock Grid.Column="3" Text="Opened At" FontWeight="Bold"/>
            <TextBlock Grid.Column="4" Text="Last Volunteer" FontWeight="Bold"/>
            <TextBlock Grid.Column="5" Text="Total Assignments" FontWeight="Bold"/>
            <TextBlock Grid.Column="6" Text="Actions" FontWeight="Bold"/>
        </Grid>

        --><!-- Call List with Grouping --><!--
        <ListView ItemsSource="{Binding CallListView}"
                  ItemTemplate="{StaticResource CallRowTemplate}"
                  Margin="10"
                  IsSynchronizedWithCurrentItem="True"
                  SelectedItem="{Binding SelectedCall, Mode=TwoWay}"
                  MouseDoubleClick="ListView_MouseDoubleClick">
            <ListView.GroupStyle>
                <GroupStyle>
                    <GroupStyle.HeaderTemplate>
                        <DataTemplate>
                            <TextBlock FontWeight="Bold" FontSize="14" Text="{Binding Name}" Margin="0,5,0,0"/>
                        </DataTemplate>
                    </GroupStyle.HeaderTemplate>
                </GroupStyle>
            </ListView.GroupStyle>
        </ListView>
    </DockPanel>
</Window>-->
<Window x:Class="PL.CallListWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:local="clr-namespace:PL"
        Title="Call Management" Height="400" Width="900"
        DataContext="{Binding RelativeSource={RelativeSource Self}}"
        xmlns:conv="clr-namespace:PL.Converters"
        WindowStartupLocation="CenterScreen"
        Loaded="Window_Loaded"
        Closed="Window_Closed">

    <Window.Resources>
        <conv:DeleteButtonVisibilityConverter x:Key="DeleteButtonVisibilityConverter" />
        <conv:CancelAssignmentVisibilityConverter x:Key="CancelAssignmentVisibilityConverter" />
        <DataTemplate x:Key="CallRowTemplate">
            <Grid Margin="2">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="80"/>
                    <ColumnDefinition Width="120"/>
                    <ColumnDefinition Width="120"/>
                    <ColumnDefinition Width="120"/>
                    <ColumnDefinition Width="120"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="80"/>
                    <ColumnDefinition Width="110"/>
                </Grid.ColumnDefinitions>
                <TextBlock Grid.Column="0" Text="{Binding CallId}" VerticalAlignment="Center"/>
                <TextBlock Grid.Column="1" Text="{Binding CallType}" VerticalAlignment="Center"/>
                <TextBlock Grid.Column="2" Text="{Binding Status}" VerticalAlignment="Center"/>
                <TextBlock Grid.Column="3" Text="{Binding OpenTime, StringFormat=dd/MM/yyyy HH:mm}" VerticalAlignment="Center"/>
                <TextBlock Grid.Column="4" Text="{Binding LastVolunteerName}" VerticalAlignment="Center"/>
                <TextBlock Grid.Column="5" Text="{Binding AssignmentsCount}" VerticalAlignment="Center"/>
                <Button Grid.Column="6" Content="Delete" Margin="2,0,0,0"
                        Click="DeleteCall_Click"
                        Visibility="{Binding Path=., Converter={StaticResource DeleteButtonVisibilityConverter}}"
                        Tag="{Binding}"/>
                <Button Grid.Column="7" Content="Cancel Assignment" Margin="2,0,0,0"
                        Click="CancelAssignment_Click"
                        Visibility="{Binding Path=., Converter={StaticResource CancelAssignmentVisibilityConverter}}"
                        Tag="{Binding}"/>
            </Grid>
        </DataTemplate>
    </Window.Resources>

    <DockPanel>
        <!-- Filter/Sort/Group Bar -->
        <StackPanel Orientation="Horizontal" DockPanel.Dock="Top" Margin="10">
            <TextBlock Text="Filter by Type:" Margin="0,0,5,0" VerticalAlignment="Center"/>
            <ComboBox ItemsSource="{Binding CallTypeCollection}"
                      SelectedItem="{Binding SelectedCallType, Mode=TwoWay}"
                      Width="110" Margin="0,0,10,0"
                      VerticalAlignment="Center"/>
            <TextBlock Text="Filter by Status:" Margin="0,0,5,0" VerticalAlignment="Center"/>
            <ComboBox ItemsSource="{Binding CallStatusCollection}"
                      SelectedItem="{Binding SelectedCallStatus, Mode=TwoWay}"
                      Width="110" Margin="0,0,10,0"
                      VerticalAlignment="Center"/>
            <TextBlock Text="Sort by:" Margin="0,0,5,0" VerticalAlignment="Center"/>
            <ComboBox ItemsSource="{Binding SortFields}"
                      SelectedItem="{Binding SelectedSortField, Mode=TwoWay}"
                      Width="110" Margin="0,0,10,0"
                      VerticalAlignment="Center"/>
            <TextBlock Text="Group by:" Margin="0,0,5,0" VerticalAlignment="Center"/>
            <ComboBox ItemsSource="{Binding GroupFields}"
                      SelectedItem="{Binding SelectedGroupField, Mode=TwoWay}"
                      Width="110"
                      VerticalAlignment="Center"/>
            <Button Content="Add Call" Margin="20,0,0,0" Padding="10,2"
                    Click="AddCall_Click"/>
        </StackPanel>

        <!-- Headers -->
        <Grid DockPanel.Dock="Top" Margin="10,0,10,0">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="80"/>
                <ColumnDefinition Width="120"/>
                <ColumnDefinition Width="120"/>
                <ColumnDefinition Width="120"/>
                <ColumnDefinition Width="120"/>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="80"/>
            </Grid.ColumnDefinitions>
            <TextBlock Grid.Column="0" Text="ID" FontWeight="Bold"/>
            <TextBlock Grid.Column="1" Text="Call Type" FontWeight="Bold"/>
            <TextBlock Grid.Column="2" Text="Status" FontWeight="Bold"/>
            <TextBlock Grid.Column="3" Text="Opened At" FontWeight="Bold"/>
            <TextBlock Grid.Column="4" Text="Last Volunteer" FontWeight="Bold"/>
            <TextBlock Grid.Column="5" Text="Total Assignments" FontWeight="Bold"/>
            <TextBlock Grid.Column="6" Text="Actions" FontWeight="Bold"/>
        </Grid>

        <!-- Call List with Grouping -->
        <ListView ItemsSource="{Binding CallListView}"
                  ItemTemplate="{StaticResource CallRowTemplate}"
                  Margin="10"
                  IsSynchronizedWithCurrentItem="True"
                  SelectedItem="{Binding SelectedCall, Mode=TwoWay}"
                  MouseDoubleClick="ListView_MouseDoubleClick">
            <ListView.GroupStyle>
                <GroupStyle>
                    <GroupStyle.HeaderTemplate>
                        <DataTemplate>
                            <TextBlock FontWeight="Bold" FontSize="14" Text="{Binding Name}" Margin="0,5,0,0"/>
                        </DataTemplate>
                    </GroupStyle.HeaderTemplate>
                </GroupStyle>
            </ListView.GroupStyle>
        </ListView>
    </DockPanel>
</Window>
